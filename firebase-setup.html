<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Setup - Online Examination System</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <div class="bg-white p-8 rounded-lg shadow-md w-full max-w-md">
        <h1 class="text-2xl font-bold text-center text-indigo-600 mb-6">Firebase Setup</h1>
        <p class="mb-4">This will initialize your Firebase project with an admin user and sample questions.</p>
        <p class="mb-4">Admin credentials will be:</p>
        <ul class="list-disc pl-5 mb-4">
            <li>Username: <strong>admin</strong></li>
            <li>Password: <strong>admin123</strong></li>
        </ul>
        <button id="setupButton" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
            Run Setup
        </button>
        <div id="status" class="mt-4 text-center"></div>
        
        <div class="mt-6 text-center">
            <a href="index.html" class="text-sm text-indigo-600 hover:text-indigo-500">
                Back to Home
            </a>
        </div>
    </div>
    
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAUIdE_Vb_sdWoSU7_eSjgx0pjz6_Tks7s",
            authDomain: "tes-quiz-app-3f0a1.firebaseapp.com",
            projectId: "tes-quiz-app-3f0a1",
            storageBucket: "tes-quiz-app-3f0a1.appspot.com",
            messagingSenderId: "701178639009",
            appId: "1:701178639009:web:628bae20116f173edff6e0",
            measurementId: "G-EGCK4HSTB8"
        };

        // Initialize Firebase
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const db = firebase.firestore();

        // Create admin user
        async function createAdminUser() {
            try {
                // Create admin user with email/password
                const userCredential = await firebase.auth().createUserWithEmailAndPassword(
                    "admin@example.com", 
                    "admin123"
                );
                
                console.log("Admin user created successfully:", userCredential.user.uid);
                
                // Add admin role to user in Firestore
                await db.collection('users').doc(userCredential.user.uid).set({
                    email: "admin@example.com",
                    role: "admin",
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                console.log("Admin role assigned successfully");
                
                // Initialize sample questions
                await initializeSampleQuestions();
                
                return true;
            } catch (error) {
                console.error("Error during setup:", error);
                throw error;
            }
        }

        // Initialize sample questions for each class
        async function initializeSampleQuestions() {
            // Sample questions for each class and section
            const classQuestions = {
                "Primary 1 - Orange": [
                    {
                        question: "What is 1 + 1?",
                        options: ["1", "2", "3", "4"],
                        correctAnswer: "2"
                    },
                    {
                        question: "Which animal says 'meow'?",
                        options: ["Dog", "Cat", "Cow", "Lion"],
                        correctAnswer: "Cat"
                    }
                ],
                "Primary 1 - Lemon": [
                    {
                        question: "What color is the sky?",
                        options: ["Red", "Green", "Blue", "Yellow"],
                        correctAnswer: "Blue"
                    },
                    {
                        question: "How many days are in a week?",
                        options: ["5", "6", "7", "8"],
                        correctAnswer: "7"
                    }
                ],
                "Primary 1 - Yellow": [
                    {
                        question: "Which shape has 3 sides?",
                        options: ["Circle", "Square", "Triangle", "Rectangle"],
                        correctAnswer: "Triangle"
                    },
                    {
                        question: "What comes after the number 9?",
                        options: ["8", "10", "11", "12"],
                        correctAnswer: "10"
                    }
                ],
                "Primary 2 - Orange": [
                    {
                        question: "What is 5 + 7?",
                        options: ["10", "11", "12", "13"],
                        correctAnswer: "12"
                    },
                    {
                        question: "Which planet do we live on?",
                        options: ["Mars", "Earth", "Jupiter", "Venus"],
                        correctAnswer: "Earth"
                    }
                ],
                "Primary 2 - Lemon": [
                    {
                        question: "How many hours are in a day?",
                        options: ["12", "18", "24", "36"],
                        correctAnswer: "24"
                    },
                    {
                        question: "Which animal has a long neck?",
                        options: ["Elephant", "Giraffe", "Lion", "Zebra"],
                        correctAnswer: "Giraffe"
                    }
                ],
                "Primary 2 - Yellow": [
                    {
                        question: "What is 10 - 3?",
                        options: ["5", "6", "7", "8"],
                        correctAnswer: "7"
                    },
                    {
                        question: "Which season comes after summer?",
                        options: ["Winter", "Spring", "Fall", "None of these"],
                        correctAnswer: "Fall"
                    }
                ],
                "Primary 3 - Orange": [
                    {
                        question: "What is 4 × 6?",
                        options: ["18", "20", "24", "28"],
                        correctAnswer: "24"
                    },
                    {
                        question: "Which is the largest ocean?",
                        options: ["Atlantic", "Indian", "Arctic", "Pacific"],
                        correctAnswer: "Pacific"
                    }
                ],
                "Primary 3 - Lemon": [
                    {
                        question: "How many sides does a hexagon have?",
                        options: ["4", "5", "6", "8"],
                        correctAnswer: "6"
                    },
                    {
                        question: "Which gas do plants absorb from the air?",
                        options: ["Oxygen", "Carbon Dioxide", "Nitrogen", "Hydrogen"],
                        correctAnswer: "Carbon Dioxide"
                    }
                ],
                "Primary 3 - Yellow": [
                    {
                        question: "What is 25 ÷ 5?",
                        options: ["3", "4", "5", "6"],
                        correctAnswer: "5"
                    },
                    {
                        question: "Which is not a primary color?",
                        options: ["Red", "Blue", "Green", "Yellow"],
                        correctAnswer: "Green"
                    }
                ],
                "Primary 4 - Orange": [
                    {
                        question: "What is the capital of France?",
                        options: ["London", "Berlin", "Paris", "Madrid"],
                        correctAnswer: "Paris"
                    },
                    {
                        question: "How many continents are there?",
                        options: ["5", "6", "7", "8"],
                        correctAnswer: "7"
                    }
                ],
                "Primary 4 - Lemon": [
                    {
                        question: "What is 12 × 12?",
                        options: ["124", "144", "156", "168"],
                        correctAnswer: "144"
                    },
                    {
                        question: "Which planet is known as the Red Planet?",
                        options: ["Venus", "Mars", "Jupiter", "Saturn"],
                        correctAnswer: "Mars"
                    }
                ],
                "Primary 4 - Yellow": [
                    {
                        question: "What is the largest mammal?",
                        options: ["Elephant", "Blue Whale", "Giraffe", "Hippopotamus"],
                        correctAnswer: "Blue Whale"
                    },
                    {
                        question: "How many degrees are in a right angle?",
                        options: ["45", "90", "180", "360"],
                        correctAnswer: "90"
                    }
                ],
               "Primary 5 - Orange": [
    {
        question: "What is Mobirise?",
        options: ["A video game", "A photo app", "A website builder", "A phone"],
        correctAnswer: "A website builder"
    },
    {
        question: "Why do people use Mobirise?",
        options: ["To play games", "To draw cartoons", "To create websites", "To write books"],
        correctAnswer: "To create websites"
    },
    {
        question: "Can you use Mobirise to learn how to make websites?",
        options: ["No", "Yes", "Only with a teacher", "Only with money"],
        correctAnswer: "Yes"
    },
    {
        question: "What can you share with a website?",
        options: ["Videos only", "Books", "Information", "Clothes"],
        correctAnswer: "Information"
    },
    {
        question: "What is a wireframe?",
        options: ["A picture frame", "A type of computer", "A rough sketch of a website", "A video"],
        correctAnswer: "A rough sketch of a website"
    },
    {
        question: "What does a wireframe show?",
        options: ["Where buttons, pictures, and text go", "The color of the site", "The logo only", "Only pictures"],
        correctAnswer: "Where buttons, pictures, and text go"
    },
    {
        question: "Why is using a wireframe helpful?",
        options: ["To plan the website", "To draw cartoons", "To color pages", "To write poems"],
        correctAnswer: "To plan the website"
    },
    {
        question: "What is wireframing like?",
        options: ["Playing a game", "Drawing a map before a treasure hunt", "Taking photos", "Painting a wall"],
        correctAnswer: "Drawing a map before a treasure hunt"
    },
    {
        question: "What assignment was given in your notes?",
        options: ["Write a poem", "Build a robot", "Sketch your school wireframe", "Watch a movie"],
        correctAnswer: "Sketch your school wireframe"
    },
    {
        question: "What can you add to make a website interesting?",
        options: ["Just one word", "Words, pictures, and buttons", "Nothing", "Only colors"],
        correctAnswer: "Words, pictures, and buttons"
    },
    {
        question: "Why is adding text important?",
        options: ["To make music", "To help people understand the website", "To draw cartoons", "To share jokes"],
        correctAnswer: "To help people understand the website"
    },
    {
        question: "What does an image do on a website?",
        options: ["Show what you’re talking about", "Make the site heavy", "Add errors", "Play a song"],
        correctAnswer: "Show what you’re talking about"
    },
    {
        question: "What do buttons do on a website?",
        options: ["Change the background", "Make the page louder", "Let people click and go somewhere", "Add lights"],
        correctAnswer: "Let people click and go somewhere"
    },
    {
        question: "Where can you add buttons on a website?",
        options: ["Inside text only", "Anywhere you want", "Only at the bottom", "On paper"],
        correctAnswer: "Anywhere you want"
    },
    {
        question: "Can you add both text and images to a Mobirise website?",
        options: ["No", "Yes", "Only one", "Only pictures"],
        correctAnswer: "Yes"
    },
    {
        question: "Which of these helps make a website fun and interesting?",
        options: ["Text only", "Text and images only", "Text, images, and buttons", "A blank page"],
        correctAnswer: "Text, images, and buttons"
    },
    {
        question: "If you don’t use a wireframe, what could happen?",
        options: ["The site will be colorful", "You may get confused", "The website will sing", "Nothing"],
        correctAnswer: "You may get confused"
    },
    {
        question: "What can you do after planning your wireframe?",
        options: ["Leave the project", "Add real content like pictures and buttons", "Erase it", "Watch TV"],
        correctAnswer: "Add real content like pictures and buttons"
    },
    {
        question: "Who can use Mobirise to create websites?",
        options: ["Only adults", "Only coders", "Anyone, even beginners", "Only teachers"],
        correctAnswer: "Anyone, even beginners"
    },
    {
        question: "What helps you decide where things go on your webpage?",
        options: ["Guessing", "A wireframe", "A video", "A game"],
        correctAnswer: "A wireframe"
    }
],

                "Primary 5 - Lemon": [
                    {
                        question: "What is 15% of 200?",
                        options: ["15", "20", "30", "35"],
                        correctAnswer: "30"
                    },
                    {
                        question: "Which organ pumps blood around the body?",
                        options: ["Lungs", "Brain", "Heart", "Liver"],
                        correctAnswer: "Heart"
                    }
                ],
                "Primary 5 - Yellow": [
                    {
                        question: "What is the square root of 81?",
                        options: ["7", "8", "9", "10"],
                        correctAnswer: "9"
                    },
                    {
                        question: "Which gas makes up most of Earth's atmosphere?",
                        options: ["Oxygen", "Carbon Dioxide", "Nitrogen", "Hydrogen"],
                        correctAnswer: "Nitrogen"
                    }
                ]
            };
            
            // Add questions to Firestore
            const batch = db.batch();
            
            for (const [classSection, questions] of Object.entries(classQuestions)) {
                const [className, section] = classSection.split(" - ");
                
                questions.forEach((question, index) => {
                    const docRef = db.collection('questions').doc(`${className.replace(/\s+/g, '')}_${section}_${index}`);
                    batch.set(docRef, {
                        ...question,
                        class: className,
                        section: section,
                        order: index
                    });
                });
            }
            
            await batch.commit();
            console.log("Sample questions initialized successfully");
        }

        // Add event listener to setup button
        document.getElementById('setupButton').addEventListener('click', function() {
            this.disabled = true;
            this.textContent = 'Setting up...';
            document.getElementById('status').textContent = 'Creating admin user and initializing data...';
            
            createAdminUser().then(() => {
                this.textContent = 'Setup Complete!';
                document.getElementById('status').innerHTML = 'Setup completed successfully!<br><a href="admin-login.html" class="text-indigo-600">Go to Admin Login</a>';
            }).catch(error => {
                this.disabled = false;
                this.textContent = 'Try Again';
                document.getElementById('status').textContent = 'Error: ' + error.message;
                
                // Special handling for "email-already-in-use" error
                if (error.code === 'auth/email-already-in-use') {
                    document.getElementById('status').innerHTML = 'Admin user already exists.<br>You can <a href="admin-login.html" class="text-indigo-600">Go to Admin Login</a> and use username: admin, password: admin123';
                    this.textContent = 'Setup Complete!';
                    this.disabled = true;
                }
            });
        });
    </script>
</body>
</html>
